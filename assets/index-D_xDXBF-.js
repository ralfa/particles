(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();const $=require("canvas-sketch"),y=require("canvas-sketch-util/random"),E=require("canvas-sketch-util/math"),j=require("eases"),H=require("colormap"),K={dimensions:[1080,1080],animate:!0},x=[],c={x:9999,y:9999};H({colormap:"viridis",nshades:20});let f,n;const U=({width:a,height:t,canvas:i})=>{let e,s,o,h;const g=document.createElement("canvas"),L=g.getContext("2d");g.width=n.width,g.height=n.height,L.drawImage(n,0,0);const v=L.getImageData(0,0,n.width,n.height).data,P=30,O=1,A=1;let q=11,p=.1;const w=q;f=i,i.addEventListener("mousedown",W);for(let r=0;r<P;r++){const u=Math.PI*2*p,l=r?Math.floor(u/(w*2+A)):1,d=Math.PI*2/l;for(let m=0;m<l;m++){const I=d*m;e=Math.cos(I)*p,s=Math.sin(I)*p,e+=a*.5,s+=t*.5;const C=Math.floor(e/a*n.width),M=(Math.floor(s/t*n.height)*n.width+C)*4,D=v[M+0],R=v[M+1],S=v[M+2],N=`rgb(${D}, ${R}, ${S})`;h=E.mapRange(D,0,255,1,12),o=new z({x:e,y:s,radius:h,colA:N}),x.push(o)}p+=w*2+O,q=(1-j.quadOut(r/P))*w}return({context:r,width:u,height:l})=>{r.save(),r.fillStyle="black",r.fillRect(0,0,u,l),r.translate(u/2,l/2),r.scale(.68,.68),r.translate(-u/2,-l/2),r.drawImage(g,0,0),x.sort((d,m)=>d.scale-m.scale),x.forEach(d=>{d.update(),d.draw(r)}),r.restore()}},W=a=>{window.addEventListener("mousemove",F),window.addEventListener("mouseup",b),F(a)},F=a=>{const t=a.offsetX/f.offsetWidth*f.width,i=a.offsetY/f.offsetHeight*f.height;c.x=t,c.y=i,console.log(c)},b=a=>{window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",b),c.x=9999,c.y=9999},X=async a=>new Promise((t,i)=>{const e=new Image;e.onload=()=>t(e),e.onerror=()=>i(),e.src=a}),Y=async()=>{n=await X("images/image-01.png"),$(U,K)};Y();class z{constructor({x:t,y:i,radius:e=10,colA:s}){this.x=t,this.y=i,this.ax=0,this.ay=0,this.vx=0,this.vy=0,this.ix=t,this.iy=i,this.radius=e,this.scale=1,this.color=s,this.minDist=y.range(100,200),this.pushFactor=y.range(.02,.02),this.pullFactor=y.range(.002,.006),this.dampFactor=y.range(.9,.95)}update(){let t,i,e,s;t=this.ix-this.x,i=this.iy-this.y,e=Math.sqrt(t*t+i*i),this.ax=t*this.pullFactor,this.ay=i*this.pullFactor,this.scale=E.mapRange(e,0,200,1,5),t=this.x-c.x,i=this.y-c.y,e=Math.sqrt(t*t+i*i),s=this.minDist-e,e<this.minDist&&(this.ax+=t/e*s*this.pushFactor,this.ay+=i/e*s*this.pushFactor),this.vx+=this.ax,this.vy+=this.ay,this.vx*=this.dampFactor,this.vy*=this.dampFactor,this.x+=this.vx,this.y+=this.vy}draw(t){t.save(),t.translate(this.x,this.y),t.fillStyle=this.color,t.beginPath(),t.arc(0,0,this.radius*this.scale,0,Math.PI*2),t.fill(),t.restore()}}
